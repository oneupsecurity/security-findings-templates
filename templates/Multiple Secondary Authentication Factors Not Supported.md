# Title

Multiple Secondary Authentication Factors Not Supported

# Risk
Low

# Description

The [TKTK application name] application allows users to authenticate using a [One-time Password sent over SMS messaging, or Time-based One Time Password (TOTP) generated by an authenticator]. Users who lose access to their secondary authentication method will be locked out of their account. By allowing users to enroll multiple secondary authentication factors, users can use a backup authentication factor to regain access to their account.

The following screenshot demonstrates only a single secondary factor authentication can be registered to an account.

[TKTK Place Screentshot here of login form and post login page]

Following is the [TKTKK application name] application's code which handles secondary factor enrollment.  On line [TKTK 31] , note how only a single authetnicator can be enrolled.

From [TKTK  URL , the method *SomeController.displayPosts()* defined in *filePath* , the function *displayPosts()* defined in *filePath*, etc]:
~~~
[ TKTK Place code snippet here with numbered lines. Ex:

  313 logInUser(user,password)
]

~~~

# Proof of Concept

[TKTK Explain Reproduction Steps. Paste request/responses, or explain actions taken through website to exploit,etc.]


# Recommendations

Allow users to enroll multiple authenticators to reduce the risk of users being locked out of their accounts. Require users to re-authenticate with their password and an actively enrolled second factor when making authentication related changes.


# References
"OWASP Top 10-2017 A2-Broken Authentication" - https://www.owasp.org/index.php/Top_10-2017_A2-Broken_Authentication
"NIST Special Publication 800-63B - Digital Identity Guidelines -  Authentication and Lifecycle Management, Section 6.1.2.2 Adding an Additional Factor to a Single-Factor Account" - https://pages.nist.gov/800-63-3/sp800-63b.html#bindexisting
